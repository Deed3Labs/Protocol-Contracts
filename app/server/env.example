# Server Configuration
PORT=3001
NODE_ENV=development

# Redis Configuration
# Option 1: Use REDIS_URL (recommended for cloud providers like Upstash)
REDIS_URL=redis://default:password@host:6379

# Option 2: Use individual settings (for local or custom Redis)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_TLS=false

# External API Keys (optional)
COINGECKO_API_KEY=
RPC_PROVIDER_API_KEY=

# Plaid API Keys (for bank linking and balance display)
# Get your keys from: https://dashboard.plaid.com/developers/keys
# PLAID_ENV: sandbox (development) or production
PLAID_CLIENT_ID=
PLAID_SECRET=
PLAID_ENV=sandbox
# Required for OAuth institutions (e.g. Chase) in web Link flows.
# Must be added in Plaid Dashboard -> Team settings -> Allowed redirect URIs.
# Example: https://app.example.com/
PLAID_REDIRECT_URI=

# Persistent encrypted Plaid token storage (Postgres + envelope encryption)
# DATABASE_URL is required so linked Plaid items survive restarts and multiple server instances.
DATABASE_URL=
# Optional Postgres tuning
# POSTGRES_POOL_MAX=10
# POSTGRES_IDLE_TIMEOUT_MS=30000
# POSTGRES_CONNECTION_TIMEOUT_MS=10000
# POSTGRES_SSL_MODE=require
# Optional table name override
# PLAID_TOKEN_STORE_TABLE=plaid_linked_items
#
# Encryption key configuration (AES-256 envelope encryption):
# Option A (simple): one active key (recommended minimum)
# - 32-byte key encoded as base64 or hex
# - Example generation: openssl rand -base64 32
PLAID_TOKEN_MASTER_KEY=
# Optional active key version label for rotation bookkeeping
PLAID_TOKEN_ACTIVE_KEY_VERSION=v1
#
# Option B (rotation): keyring JSON mapping versions to key material
# Example: {"v1":"base64:...","v2":"base64:..."}
# PLAID_TOKEN_KEYRING_JSON=

# Stripe API Keys (for crypto onramp)
# Get your keys from: https://dashboard.stripe.com/apikeys
# Note: You must submit an onramp application before using in production
# See: https://docs.stripe.com/crypto/onramp
STRIPE_SECRET_KEY=

# Bridge (ACH/wire funding to wallet)
# BRIDGE_FUNDING_URL_BASE: base URL for Bridge funding flow (query params: wallet, amount, currency, network)
# BRIDGE_ONBOARDING_URL_BASE: optional base URL for Bridge onboarding/direct-deposit setup (query params: wallet, intent, flow)
# BRIDGE_API_KEY: recommended for real hosted onboarding links (kyc_link + tos_link)
# BRIDGE_API_BASE_URL: Bridge API base (default: https://api.bridge.xyz/v0)
#   Sandbox: https://api.sandbox.bridge.xyz/v0
# BRIDGE_ONBOARDING_REDIRECT_URI: optional redirect URL Bridge should send users back to after hosted onboarding steps
# BRIDGE_API_TIMEOUT_MS: request timeout for Bridge API calls (default: 15000)
BRIDGE_FUNDING_URL_BASE=
BRIDGE_ONBOARDING_URL_BASE=
BRIDGE_API_KEY=
BRIDGE_API_BASE_URL=https://api.bridge.xyz/v0
BRIDGE_ONBOARDING_REDIRECT_URI=
# BRIDGE_API_TIMEOUT_MS=15000

# OpenSea API Key (for NFT floor price fallback)
# Get your free API key at: https://docs.opensea.io/reference/api-overview
# Required for NFT pricing on non-Ethereum chains (Base, Polygon, Arbitrum, etc.)
# Alchemy NFT API is used for Ethereum mainnet, OpenSea is fallback
OPENSEA_API_KEY=

# Alchemy API Key (recommended for production)
# Get your free API key at: https://dashboard.alchemy.com/
# If set, will automatically construct Alchemy RPC URLs for all supported chains
# This is the easiest way to use Alchemy - just set this one variable!
ALCHEMY_API_KEY=

# Alchemy compute unit alerts (optional)
# ALCHEMY_CU_ALERT_THRESHOLD=100000   # Per-user 24h; warn if user exceeds this (default 100000)
# ALCHEMY_CU_DAILY_ALERT_THRESHOLD=   # Global 24h; warn if total 24h CUs exceed this (e.g. 2000000)

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Cache TTLs (in seconds)
CACHE_TTL_PRICE=300  # 5 minutes - aligned with WebSocket price update interval
CACHE_TTL_BALANCE=300  # 5 minutes - increased from 10s to align with WebSocket balance update interval (5 min) and reduce Alchemy compute unit usage
CACHE_TTL_PLAID_BALANCES=3600  # 1 hour - Plaid bank balance cache (~$0.10/call). Use ?refresh=1 to bypass.
CACHE_TTL_PLAID_RECURRING=86400  # 24 hours - recurring streams change rarely (monthly). Use ?refresh=1 to bypass.
CACHE_TTL_PLAID_SPEND=3600  # 1 hour - spend-by-day for current month. Use ?refresh=1 to bypass.
CACHE_TTL_PLAID_LIABILITIES=3600  # 1 hour - credit/loan liability detail cache. Use ?refresh=1 to bypass.
CACHE_TTL_PLAID_INVESTMENT_ACCOUNTS=3600  # 1 hour - investment account summary cache. Use ?refresh=1 to bypass.
CACHE_TTL_NFT=1800  # 30 minutes - increased to reduce Alchemy compute unit usage
CACHE_TTL_TRANSACTION=600  # 10 minutes - increased to align with refresh intervals and reduce Alchemy compute unit usage
CACHE_TTL_RPC=5  # 5 seconds - short TTL for RPC calls (quick cache for repeated requests)

# CORS
CORS_ORIGIN=http://localhost:5173
ALLOW_VERCEL_PREVIEWS=false
# Set true to require explicit CORS_ORIGIN (otherwise compatibility mode allows all origins)
STRICT_CORS=false

# Reown / SIWX auth verification
# Required for protected routes: /api/stripe, /api/plaid, /api/bridge
# Set to the same project ID used by the frontend AppKit config.
REOWN_PROJECT_ID=
# Optional overrides (defaults shown)
# REOWN_AUTH_BASE_URL=https://api.web3modal.org
# REOWN_SDK_TYPE=appkit
# REOWN_SDK_VERSION=html-wagmi-4.2.2
# AUTH_CACHE_TTL_MS=300000

# Plaid limits
# Maximum number of linked Plaid items per wallet
MAX_PLAID_ITEMS_PER_WALLET=10

# RPC URLs (optional - only needed if you want to override Alchemy URLs or use a different provider)
# Priority: Custom URL > Alchemy (if ALCHEMY_API_KEY set) > Public fallback
# If you set ALCHEMY_API_KEY above, you don't need to set these individually
# Format examples:
#   ETHEREUM_RPC_URL=https://eth-mainnet.g.alchemy.com/v2/YOUR_API_KEY
#   SEPOLIA_RPC_URL=https://eth-sepolia.g.alchemy.com/v2/YOUR_API_KEY
ETHEREUM_RPC_URL=
BASE_RPC_URL=
GNOSIS_RPC_URL=
POLYGON_RPC_URL=
ARBITRUM_RPC_URL=
SEPOLIA_RPC_URL=
BASE_SEPOLIA_RPC_URL=
MUMBAI_RPC_URL=
